---
title: "tidyr-101"
author: "Rodrigo"
format: html
---

```{r}
#| message: false
here::i_am("dm-course-git-101.Rproj")
library(here)
```

```{r}

#| message: false

library(ggplot2)

library(dplyr)
library(tidyr)
```


```{r}
data("EuStockMarkets")
```

```{r}
ggplot(EuStockMarkets, aes(y=DAX,x=time(EuStockMarkets))) +
  geom_line()
```

```{r}
EuStockMarkets <- 
  EuStockMarkets |>
    as_tibble() |>
    mutate(date=as.numeric(time(EuStockMarkets)))
```

```{r}
ggplot(EuStockMarkets, aes(y=DAX,x=date)) +
  geom_line()
```

```{r}
ggplot(EuStockMarkets,aes(y=CAC,x=date))+
  geom_line()
```



```{r}
ggplot(EuStockMarkets,aes(y=CAC,x=date))+
  geom_line(color="steelblue")+
  geom_line(mapping = aes(y=DAX),color="salmon")
```

### Tidyr Solution

```{r}
EuStockMarkets |>
  pivot_longer(!date, names_to="index") |>
  slice_head(n=10) |>
  knitr::kable()

```

```{r}
EuStockMarkets |>
  pivot_longer(!date, names_to="index") |>
  ggplot(aes(x=date, y=value, colour=index))+
  geom_line()
```


```{r}
EuStockMarkets |>
  pivot_longer(everything())|>
   slice_head(n=10) |>
  knitr::kable()

```


```{r}
EuStockMarkets |>
  pivot_longer(DAX|SMI)|>
   slice_head(n=10) |>
  knitr::kable()
```

